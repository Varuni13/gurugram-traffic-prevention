<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gurugram Mobility Dashboard | Traffic & Flood Monitoring</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="./style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Chart.js for Traffic Trend -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
    <!-- Professional Header Bar -->
    <header class="app-header">
        <div class="header-brand">
            <div class="brand-icon">
                <img src="./logo.png" alt="Gurugram Mobility Logo" class="header-logo" />
            </div>
            <div class="brand-text">
                <h1>Gurugram Mobility</h1>
                <span class="brand-subtitle">Real-time Traffic & Flood Monitoring</span>
            </div>
        </div>
        <div class="header-status">
            <!-- Traffic Flow Gradient in Header -->
            <div class="header-traffic-legend">
                <div class="header-gradient-bar"></div>
                <span class="header-gradient-label">Traffic</span>
            </div>
            <!-- Dark Mode Toggle -->
            <button id="darkModeToggle" class="dark-mode-btn" title="Toggle Dark Mode">
                <span class="mode-icon">üåô</span>
            </button>
            <div class="live-indicator">
                <span class="live-dot"></span>
                <span class="live-text">LIVE</span>
            </div>
            <div class="header-time" id="headerTime">--:--</div>
        </div>
    </header>

    <!-- Traffic Status Cards -->
    <div class="traffic-status-bar">
        <div class="status-card status-smooth">
            <div class="status-icon">üü¢</div>
            <div class="status-info">
                <span class="status-count" id="smoothCount">--</span>
                <span class="status-label">Smooth</span>
            </div>
        </div>
        <div class="status-card status-moderate">
            <div class="status-icon">üü°</div>
            <div class="status-info">
                <span class="status-count" id="moderateCount">--</span>
                <span class="status-label">Moderate</span>
            </div>
        </div>
        <div class="status-card status-heavy">
            <div class="status-icon">üî¥</div>
            <div class="status-info">
                <span class="status-count" id="heavyCount">--</span>
                <span class="status-label">Heavy</span>
            </div>
        </div>
    </div>

    <div id="control-panel">
        <!-- <div class="panel-header">
            <div class="panel-title">
                <span class="panel-icon">üó∫Ô∏è</span>
                <span>Control Panel</span>
            </div>
            <div class="data-status">
                <span class="status-badge" id="dataStatus">Ready</span>
            </div>
        </div> -->

        <!-- SECTION 1: Time Control -->
        <div class="accordion-section">
            <div class="accordion-header" onclick="toggleAccordion('timeSection')">
                <span class="accordion-icon">‚è±Ô∏è</span>
                <span class="accordion-title">Time Control</span>
                <span class="accordion-chevron" id="timeSection-chevron">‚ñº</span>
            </div>
            <div class="accordion-content" id="timeSection">
                <!-- Compact Time Control -->
                <div class="time-compact-row">
                    <button id="timePrevBtn" class="time-step-btn-sm" title="Previous">‚óÄ</button>
                    <div class="time-display-compact">
                        <span id="sliderCurrentTime" class="time-value-compact">--:--</span>
                    </div>
                    <button id="timeNextBtn" class="time-step-btn-sm" title="Next">‚ñ∂</button>
                </div>
                <div class="slider-full-row">
                    <span id="sliderStartTime" class="time-label-sm">--:--</span>
                    <input id="floodTimeSlider" type="range" min="0" max="0" step="1" value="0" class="time-slider-compact" />
                    <span id="sliderEndTime" class="time-label-sm">--:--</span>
                </div>
            </div>
        </div>

        <!-- SECTION 2: Route Planner -->
        <div class="accordion-section">
            <div class="accordion-header" onclick="toggleAccordion('routePlanningSection')">
                <span class="accordion-icon">üìç</span>
                <span class="accordion-title">Route Planner</span>
                <span class="accordion-chevron" id="routePlanningSection-chevron">‚ñº</span>
            </div>
            <div class="accordion-content" id="routePlanningSection">
                <!-- <div class="hint" style="margin-bottom: 6px; font-size: 9px;">Select from 25 major traffic hotspots</div> -->
                <div class="quick-route-controls">
                    <div class="quick-route-row">
                        <label>From:</label>
                        <select id="quickRouteFrom" class="quick-select">
                            <option value="">-- Select Origin --</option>
                            <option value="iffco_chowk">IFFCO Chowk</option>
                            <option value="rajiv_chowk">Rajiv Chowk</option>
                            <option value="hero_honda">Hero Honda Chowk</option>
                            <option value="kherki_daula">Kherki Daula Toll Plaza</option>
                            <option value="signature_tower">Signature Tower</option>
                            <option value="shankar_chowk">Shankar Chowk / Cyber City</option>
                            <option value="sikanderpur">Sikanderpur Metro</option>
                            <option value="huda_city">HUDA City Centre Metro</option>
                            <option value="subhash_chowk">Subhash Chowk</option>
                            <option value="jharsa_chowk">Jharsa Chowk</option>
                            <option value="atul_kataria">Atul Kataria Chowk</option>
                            <option value="mahavir_chowk">Mahavir Chowk</option>
                            <option value="ghata_chowk">Ghata Chowk</option>
                            <option value="vatika_chowk">Vatika Chowk (SPR-Sohna Rd)</option>
                            <option value="badshahpur">Badshahpur / Sohna Rd junction</option>
                            <option value="ambedkar_chowk">Ambedkar Chowk</option>
                            <option value="dundahera">Dundahera (Old Delhi Rd)</option>
                            <option value="dwarka_nh48">Dwarka Expwy-NH48</option>
                            <option value="sector31">Sector 31 Signal / Market</option>
                            <option value="old_bus_stand">Old Gurgaon Bus Stand</option>
                            <option value="imt_manesar">IMT Manesar Junction</option>
                            <option value="golf_course">Golf Course Rd - One Horizon</option>
                            <option value="sector56_57">Sector 56/57 - Golf Course Extn</option>
                            <option value="sohna_entry">Sohna Town Entry</option>
                            <option value="pataudi_rd">Pataudi Rd - Sector 89/90</option>
                        </select>
                    </div>
                    <div class="quick-route-row">
                        <label>To:</label>
                        <select id="quickRouteTo" class="quick-select">
                            <option value="">-- Select Destination --</option>
                            <option value="iffco_chowk">IFFCO Chowk</option>
                            <option value="rajiv_chowk">Rajiv Chowk</option>
                            <option value="hero_honda">Hero Honda Chowk</option>
                            <option value="kherki_daula">Kherki Daula Toll Plaza</option>
                            <option value="signature_tower">Signature Tower</option>
                            <option value="shankar_chowk">Shankar Chowk / Cyber City</option>
                            <option value="sikanderpur">Sikanderpur Metro</option>
                            <option value="huda_city">HUDA City Centre Metro</option>
                            <option value="subhash_chowk">Subhash Chowk</option>
                            <option value="jharsa_chowk">Jharsa Chowk</option>
                            <option value="atul_kataria">Atul Kataria Chowk</option>
                            <option value="mahavir_chowk">Mahavir Chowk</option>
                            <option value="ghata_chowk">Ghata Chowk</option>
                            <option value="vatika_chowk">Vatika Chowk (SPR-Sohna Rd)</option>
                            <option value="badshahpur">Badshahpur / Sohna Rd junction</option>
                            <option value="ambedkar_chowk">Ambedkar Chowk</option>
                            <option value="dundahera">Dundahera (Old Delhi Rd)</option>
                            <option value="dwarka_nh48">Dwarka Expwy-NH48</option>
                            <option value="sector31">Sector 31 Signal / Market</option>
                            <option value="old_bus_stand">Old Gurgaon Bus Stand</option>
                            <option value="imt_manesar">IMT Manesar Junction</option>
                            <option value="golf_course">Golf Course Rd - One Horizon</option>
                            <option value="sector56_57">Sector 56/57 - Golf Course Extn</option>
                            <option value="sohna_entry">Sohna Town Entry</option>
                            <option value="pataudi_rd">Pataudi Rd - Sector 89/90</option>
                        </select>
                    </div>
                    <div class="btn-row">
                        <button id="calculateQuickRouteBtn" class="btn btn-primary">Enter</button>
                        <button id="clearQuickRoutesBtn" class="btn btn-secondary">Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Route Status (always visible) -->
        <div id="routeSearchStatus" class="route-status"></div>

        <!-- OR Divider (COMMENTED OUT with Custom Route)
        <div class="or-divider">
            <span class="or-line"></span>
            <span class="or-text">OR</span>
            <span class="or-line"></span>
        </div>
        -->

        <!-- SECTION 3: Custom Route Search (COMMENTED OUT)
        <div class="accordion-section">
            <div class="accordion-header" onclick="toggleAccordion('customRouteSection')">
                <span class="accordion-icon">üîç</span>
                <span class="accordion-title">Plan Custom Route</span>
                <span class="accordion-chevron" id="customRouteSection-chevron">‚ñ∂</span>
            </div>
            <div class="accordion-content collapsed" id="customRouteSection">
                <div class="hint" style="margin-bottom: 10px;">Search any location in Gurugram</div>
                
                <div class="route-search-row">
                    <span class="route-search-icon origin-icon">A</span>
                    <div class="search-container" style="flex: 1; position: relative;">
                        <input type="text" id="originSearchInput" class="route-search-input" placeholder="Enter origin..."
                            autocomplete="off" />
                        <div id="originSearchResults" class="search-results" style="display: none;"></div>
                    </div>
                </div>

                <div class="route-search-row">
                    <span class="route-search-icon dest-icon">B</span>
                    <div class="search-container" style="flex: 1; position: relative;">
                        <input type="text" id="destSearchInput" class="route-search-input" placeholder="Enter destination..."
                            autocomplete="off" />
                        <div id="destSearchResults" class="search-results" style="display: none;"></div>
                    </div>
                </div>

                <div style="display: flex; gap: 6px; margin-top: 10px;">
                    <button id="swapLocationsBtn" class="btn" style="padding: 8px 12px;"
                        title="Swap origin and destination">‚áÖ</button>
                    <button id="findRoutesBtn" class="btn btn-primary" style="flex: 1; margin-top: 0;">üõ£Ô∏è Find Routes</button>
                </div>
            </div>
        </div>
        -->

        <!-- SECTION 4: Route Display -->
        <div class="accordion-section">
            <div class="accordion-header" onclick="toggleAccordion('routeOptionsSection')">
                <span class="accordion-icon">üõ§Ô∏è</span>
                <span class="accordion-title">Route Display</span>
                <span class="accordion-chevron" id="routeOptionsSection-chevron">‚ñº</span>
            </div>
            <div class="accordion-content" id="routeOptionsSection">
                <div class="route-checkboxes">
                    <label class="row route-option">
                        <input type="checkbox" id="routeShortest" checked />
                        <span class="route-swatch" style="background:#a23eff"></span>
                        <span>Shortest Distance</span>
                    </label>
                    <label class="row route-option">
                        <input type="checkbox" id="routeTraffic" checked />
                        <span class="route-swatch" style="background:#ca4588"></span>
                        <span>Traffic Optimized</span>
                    </label>
                    <label class="row route-option">
                        <input type="checkbox" id="routeFlood" checked />
                        <span class="route-swatch" style="background:#0c9a89"></span>
                        <span>Flood Avoidance</span>
                    </label>
                    <label class="row route-option">
                        <input type="checkbox" id="routeSmart" checked />
                        <span class="route-swatch" style="background:#4B5563"></span>
                        <span>Smart Route (Optimal)</span>
                    </label>
                </div>
                <!-- <div class="hint" style="margin-top: 6px;">Check routes to compare on map</div> -->

                <!-- Route Comparison Table -->
                <div id="routeComparisonPanel"
                    style="display: none; margin-top: 16px; padding-top: 12px; border-top: 1px solid #e2e8f0;">
                    <div style="font-weight: 600; margin-bottom: 8px; font-size: 13px;">Route Comparison</div>
                    <table class="route-comparison-table">
                        <thead>
                            <tr>
                                <th>Route</th>
                                <th>Distance</th>
                                <th>ETA</th>
                            </tr>
                        </thead>
                        <tbody id="routeComparisonBody">
                            <!-- Rows will be injected by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECTION 5: Map Settings -->
        <div class="accordion-section">
            <div class="accordion-header" onclick="toggleAccordion('layersSection')">
                <span class="accordion-icon">üó∫Ô∏è</span>
                <span class="accordion-title">Map Settings</span>
                <span class="accordion-chevron" id="layersSection-chevron">‚ñº</span>
            </div>
            <div class="accordion-content" id="layersSection">
                <!-- Base Map Selector -->
                <div class="map-style-selector">
                    <!-- <label class="selector-label">Basemap: </label> -->
                    <select id="baseMapSelector" class="map-select">
                        <option value="googleStreets">Google Streets</option>
                        <option value="googleSatellite">Google Satellite</option>
                        <option value="googleHybrid">Google Hybrid</option>
                        <option value="googleTerrain">Google Terrain</option>
                    </select>
                </div>

                <div class="layer-divider"></div>

                <label class="row">
                    <input type="checkbox" id="toggleTrafficPoints" checked />
                    <span>Traffic Indicators</span>
                </label>

                <label class="row">
                    <input type="checkbox" id="toggleTraffic" checked />
                    <span>Live Traffic Flow</span>
                </label>

                <label class="row">
                    <input type="checkbox" id="toggleFlood" checked />
                    <span>Flood Zones</span>
                </label>

                <label class="row">
                    <input type="checkbox" id="toggleRoadNetwork" />
                    <span>Road Network</span>
                </label>
            </div>
        </div>

    </div>
    <!-- END of control-panel -->

    <!-- Main Layout Container (20:80 split) -->
    <div class="main-container">
        <!-- Left Sidebar (20%) - control-panel moves here via JS -->
        <aside id="sidebar"></aside>
        
        <!-- Map Area (80%) -->
        <div id="map"></div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Move control-panel into sidebar on load
        document.addEventListener('DOMContentLoaded', function() {
            const sidebar = document.getElementById('sidebar');
            const controlPanel = document.getElementById('control-panel');
            if (sidebar && controlPanel) {
                sidebar.appendChild(controlPanel);
            }
        });
    </script>
    <script src="./app.js"></script>
</body>

</html>